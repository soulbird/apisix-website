<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="ahrefs-site-verification" content="c2f7370ecf46173f4fb25f114e74c97e0a2976d4f02f61c9b00a9d7d34e34698">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-K24PRPS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-K24PRPS",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/articles/rss.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/articles/atom.xml" title="Apache APISIX¬Æ -- Cloud-Native API Gateway Blog Atom Feed"><title data-react-helmet="true">HashiCorp Vault Secure Storage Backend in Apache APISIX Ecosystem | Apache APISIX¬Æ -- Cloud-Native API Gateway</title><meta data-react-helmet="true" property="og:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" name="twitter:image" content="https://static.apiseven.com/202202/apache-apisix.png"><meta data-react-helmet="true" property="og:url" content="https://apisix.apache.org/blog/2022/01/21/apisix-hashicorp-vault-integration"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" name="robots" content="index,follow"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="HashiCorp Vault Secure Storage Backend in Apache APISIX Ecosystem | Apache APISIX¬Æ -- Cloud-Native API Gateway"><meta data-react-helmet="true" name="description" content="This article brings you the upcoming release of the Vault-Apache APISIX integration and related details."><meta data-react-helmet="true" property="og:description" content="This article brings you the upcoming release of the Vault-Apache APISIX integration and related details."><meta data-react-helmet="true" name="keywords" content="Apache APISIX,HashiCorp,Vault,jwt-auth,authentication"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-01-21T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/bisakhmondal,https://github.com/yzeng25"><meta data-react-helmet="true" property="article:tag" content="Technology,Authentication"><link data-react-helmet="true" rel="shortcut icon" href="https://static.apiseven.com/202202/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://apisix.apache.org/blog/2022/01/21/apisix-hashicorp-vault-integration"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2022/01/21/apisix-hashicorp-vault-integration" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/zh/blog/2022/01/21/apisix-hashicorp-vault-integration" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://apisix.apache.org/blog/2022/01/21/apisix-hashicorp-vault-integration" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://38VC84A2WJ-dsn.algolia.net" crossorigin="anonymous"><link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/runtime~main.f3244aab.js" as="script">
<link rel="preload" href="https://apisix-website-static.apiseven.com/assets/js/main.86bd6361.js" as="script">
<link rel="stylesheet" href="https://apisix-website-static.apiseven.com/assets/css/styles.355196a5.css">

<script>var _paq=window._paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://analytics.apache.org/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","17"]);var e=document,p=e.createElement("script"),t=e.getElementsByTagName("script")[0];p.async=!0,p.src=a+"matomo.js",t.parentNode.insertBefore(p,t)}()</script>

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_QVmC">Skip to main content</a></div><div class="announcementBar_gVRT" style="background-color:#e8433e;color:white" role="banner"><div class="announcementBarPlaceholder_csWV"></div><div class="announcementBarContent_2kKG">ü§î Have queries regarding API Gateway? Join Slack channel to discuss <a target="_blank" rel="noopener noreferrer" href="/docs/general/join">join #apisix channel</a>! ‚≠êÔ∏è</div><button type="button" class="clean-btn close announcementBarClose_EDEK" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_IWhJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo2.svg" alt="Apache APISIX¬Æ" class="themedImage_3EHU themedImage--light_heW6 navbar__logo"><img src="/img/logo2.svg" alt="Apache APISIX¬Æ" class="themedImage_3EHU themedImage--dark_6pZL navbar__logo"><b class="navbar__title">Apache APISIX¬Æ</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/apisix/getting-started">Apache APISIX¬ÆÔ∏è</a></li><li><a class="dropdown__link" href="/docs/dashboard/USER_GUIDE">Apache APISIX¬ÆÔ∏è Dashboard</a></li><li><a class="dropdown__link" href="/docs/ingress-controller/getting-started/">Apache APISIX¬ÆÔ∏è Ingress Controller</a></li><li><a class="dropdown__link" href="/docs/helm-chart/apisix/">Apache APISIX¬ÆÔ∏è Helm Charts</a></li><li><a class="dropdown__link" href="/docs/docker/build/">Apache APISIX¬ÆÔ∏è Docker</a></li><li><a class="dropdown__link" href="/docs/java-plugin-runner/development/">Apache APISIX¬ÆÔ∏è Java Plugin Runner</a></li><li><a class="dropdown__link" href="/docs/go-plugin-runner/getting-started/">Apache APISIX¬ÆÔ∏è Go Plugin Runner</a></li><li><a class="dropdown__link" href="/docs/python-plugin-runner/getting-started/">Apache APISIX¬ÆÔ∏è Python Plugin Runner</a></li><li><a class="dropdown__link" href="/docs/general/join">General</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/blog/tags/user-case">Case Studies</a><a class="navbar__item navbar__link" href="/downloads">Downloads</a><a class="navbar__item navbar__link" href="/help">Help</a><a class="navbar__item navbar__link" href="/team">Team</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/showcase">Showcase</a></li><li><a class="dropdown__link" href="/plugins">PluginHub</a></li><li><a class="dropdown__link" href="/docs/general/join">Community</a></li><li><a class="dropdown__link" href="/docs/general/events">Events</a></li></ul></div><div class="react-toggle toggle_pM6S react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_5Cll">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_5Cll">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_xkIr"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_drON thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_+zDs margin-bottom--md">All posts</div><ul class="sidebarItemList_L38e"><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/21/weekly-report-0621">Biweekly Report (Jun 1 - Jun 15)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/14/automated-operation-base-apache-apisix">Build automated operation platform based on Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/14/beeto-with-apache-apisix">Practice of localized application with API gateway in the Middle East</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/14/how-mse-supports-canary-release-with-apache-apisix">Implementation of canary release solution based on Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/14/xueqiu-with-apache-apisix">Architecture evolution of investment platforms with API gateway</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/07/installation-performance-test-of-apigateway-apisix-on-aws-graviton3">Installation and performance testing of API Gateway Apache APISIX on AWS Graviton3</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/06/07/weekly-report-0607">Biweekly ReportÔΩúExplore the weeks of May 16th - May 31th</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/05/31/release-apache-apisix-2.14">Release Apache APISIX 2.14.1</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/05/19/weekly-report-0519">Biweekly Report (May 1 - May 15)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/05/10/weekly-report-0510">Biweekly Report (Apr 15 - Apr 30)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/04/29/interview-juzhiyuan-apache-member">Interview with JU Zhiyuan: Becoming One of the 918 ASF Members, I Felt Thrilled and Proud</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/04/22/apisix-with-tidb-practice">High Availability Configuration with TiDB and APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/04/20/cve-2022-29266">The Vulnerability of Leaking Information in Error Response from jwt-auth PluginÔºàCVE-2022-29266Ôºâ</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/04/20/weekly-report-0420">Biweekly Report (Apr 1 - Apr 14)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/04/17/api-observability">API Observability with APISIX Plugins</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/04/12/apisix-summit-asia-2022">Apache APISIX Summit ASIA 2022: API Gateway, Service Mesh and Open Source Ecology</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/28/release-apache-apisix-2.13">Apache APISIX 2.13.0 Is Released, Bringing LTS and New Features</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/24/weekly-report-0314">Biweekly ReportÔΩúExplore the weeks of Mar 1st - Mar 14th</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/05/apisix-integration-eureka-service-discovery">Integrate API Gateway with Eureka</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/04/apigateway-clickhouse-makes-logging-easier">APISIX Integrates ClickHouse to Improve Log Efficiency</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/04/apisix-uses-coredns-enable-service-discovery">Apache APISIX and CoreDNS open new doors for service discovery</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/03/develop-apisix-with-gitpod">How to Use Gitpod to Develop API Gateway?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/03/weekly-report-0228">Biweekly ReportÔΩúExplore the week of Feb 15 - Feb 28</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/02/apisix-integration-graphql-plugin">Use GraphQL with API Gateway Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/02/zhongan-usercase-with-apache-apisix">Implement Traffic Governance in Internet Insurance with APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/03/01/apisix-integration-public-api-plugin">API Gateway Apache APISIX provides enhancements on API Management</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/28/apisix-integration-opentelemetry-plugin">Upgrade of observability capabilities, API Gateway Apache APISIX integrates OpenTelemetry</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/25/consul-api-gateway">How to Integrate API Gateway and Consul?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/23/csrf-api-gateway">API Gateway Enhances Security by CSRF Plugin</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/21/nacos-api-gateway">The practice of Nacos service discovery on API Gateway</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/17/weekly-report-0214">Biweekly Report (Feb 1 - Feb 14)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/16/file-logger-api-gateway">file logger practice in API Gateway</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/11/cve-2022-24112">Apache APISIX Vulnerability for Rewriting X-REAL-IP Header (CVE-2022-24112)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/02/10/splunk-apisix-integration">Integrating Splunk HTTP Event Collector with API Gateway</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/26/apisix-integrate-forward-auth-plugin">forward-auth Plugin for Authentication Function</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/25/apisix-grpc-web-integration">Integrate Apache APISIX with gRPC-Web</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/25/release-apache-apisix-2.12">Apache APISIX 2.12.0 is Released, More Features ComingÔºÅ</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/24/apisix-with-qingcloud-meetup">Webinar | APISIX in QingCloud! </a></li><li class="sidebarItem_iLZw"><a aria-current="page" class="sidebarItemLink_Y3HD sidebarItemLinkActive_Ycqn" href="/blog/2022/01/21/apisix-hashicorp-vault-integration">HashiCorp Vault Secure Storage Backend in Apache APISIX Ecosystem</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/21/apisix-xrpc-details-and-miltilingual">Get More Details About xRPC</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/20/upyun-public-gateway-usecase">The Practice of Public Gateway in CDN Scenario from UPYUN</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/19/weekly-report-0116">Biweekly Report (Jan 1 - Jan 16)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/17/apisix-kafka-integration">APISIX integrate with Kafka for real-time log monitoring</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/13/how-to-proxy-dubbo-in-apache-apisix">Makes it More Convenient for You to Proxy Dubbo Services in Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/11/apisix-with-shardingsphere-meetup">Webinar | From API to Database</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/11/building-apisix-in-ubuntu-for-arm">How to build APISIX in ARM Ubuntu</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/05/weekly-report-1231">Biweekly Report (Dec 16 - Dec 31)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2022/01/04/authing">Use APISIX and Authing to implement centralized authentication Management</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/30/apisix-proxy-grpc-service">Use API gateway to proxy gRPC service</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/28/dashboard-cve-2021-45232">Apache APISIX Dashboard Unauthorized Access Vulnerability Announcement (CVE-2021-45232)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/24/apisix-integrate-openwhisk-plugin">Coming soon! Apache APISIX Integrate with Apache OpenWhisk</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/24/open-policy-agent">Apache APISIX integrates with Open Policy Agent</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/22/google-logging">APISIX Integrates with Google Cloud Logging</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/20/weekly-report-1215">Biweekly Report (Dec 1 - Dec 15)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/17/exposure-istio-with-apisix-ingress">Secure Exposure of Istio Services with APISIX Ingress</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/16/apisix-with-rocketmq-meetup">Webinar | Apache APISIX √ó Apache RocketMQ Online Meetup</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/15/deploy-apisix-in-kubernetes">How to Easily Deploy Apache APISIX in Kubernetes</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/13/monitor-apisix-ingress-controller-with-prometheus">Monitor APISIX Ingress Controller with Prometheus</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/10/integrate-keycloak-auth-in-apisix">How to Integrate Keycloak for Authentication with Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/08/apisix-integrate-rocketmq-logger-plugin">Apache APISIX &amp; RocketMQ Help API Log Monitoring Capabilities</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/07/apisix-integrate-skywalking-plugin">Apache APISIX Integrates with SkyWalking to Create a Full Range of Log Processing</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/02/weekly-report-1130">Biweekly ReportÔΩú11.15-11.30 Feature Highlights Update in Progress</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/01/apisix-supports-azure-functions">Apache APISIX&#x27;s integration with Azure Serverless</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/12/01/release-apache-apisix-2.11">Apache APISIX 2.11.0 is officially released with more new features</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/30/use-apisix-ingress-in-kubesphere">Using Apache APISIX Ingress Gateway to access Custom Monitoring in KubeSphere</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/26/apache-apisix-committer-experience">Contributer to Committer journey @Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/23/cve-2021-43557-research-report">APISIX request_uri variable with risk of path penetration</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/23/cve-2021-43557">Apache APISIX Path traversal in request_uri variable(CVE-2021-43557)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/22/develop-apisix-ingress-with-nocalhost-in-kubernetes">Develop APISIX Ingress Controller with Nocalhost in K8s</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/19/apisix-supports-wasm">Apache APISIX embraces the WASM ecosystem</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/17/dapr-with-apisix">How to integrate with Dapr to build Apache APISIX Gateway Controller</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/16/weekly-report-1114">Weekly Report (Sep 1 - Sep 14)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/12/apisix-datadog">Cloud Monitoring with Datadog in Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/04/skywalking">The observability of Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/03/airwallex-usercase">API Gateway Practice in Airwallex with APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/11/02/weekly-report-1031">Weekly ReportÔΩú10.15-10.31 Feature Highlights Update in Progress</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/29/extension-guide">Apache APISIX Extensions Guide</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/26/apisix-ingress">How APISIX Ingress grown from 0 to 1</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/22/cert-manager-in-ingress">Use Cert Manager to manage certificates in Apache APISIX Ingress Controller</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/18/meetup">Webinar | Apache APISIX √ó Apache SkyWalking Online Meetup</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/14/weekly-report-1014">Bieekly Report (Oct 1 - Oct 14)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/13/celebrating-300-contributors-of-apisix">New milestone for the Apache APISIX community - over 300 contributors worldwide!</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/09/apisix-ingress-techblog">A thoughtful tutorial to get started with Apache APISIX Ingress from concept to practice</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/10/01/openeuler">Apache APISIX community members help openEuler release first innovation version</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/30/weekly-report">Biweekly Report (Sep 13 - Sep 30)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/29/release-apache-apisix-2.10">Release Apache APISIX 2.10.0</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/28/wps-usercase">WPS with Apache APISIX to create new API gateway experience</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/24/youpaicloud-usercase">Practice in UPYUN with APISIX Ingress</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/18/xiaodian-usercase">Apache APISIX helps DIAN to facilitate cloud native solution</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/16/tencent-cloud">Implementing Apache APISIX in Tencent Cloud TI-ONE Platform</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/15/weekly-report">BiWeekly Report (Aug 30 - Sep 15)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/14/youzan">Youzanyun PaaS for comprehensive micro-service governance with APISX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/13/china-mobile-cloud-usercase">How APISIX implemented in China Mobile Cloud</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/09/how-to-contribute-to-an-openSource-without-coding">How can I contribute to an open source project without writing code?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/07/how-to-use-apisix-auth">Centralized Authentication with Apache APISIX and Advanced Tricks</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/07/iqiyi-usercase">Based on Apache APISIX, iQIYI API Gateway Update and landing practice</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/09/06/python-helps-you-quickly-with-apache-apisix-development">Python helps you develop Apache APISIX plugin</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/31/apache-apisix-kubeSphere-a-better-gateway-and-k8s-ingress-controller">Apache APISIX √ó KubeSphere: Providing a better gateway and K8S Ingress Controller</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/30/ingress-meeting">WebinarÔΩú See you at the Apache APISIX Ingress Community Meeting on Wednesday at 2pm!</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/30/weekly-report">Weekly Report (Aug 23 - Aug 29)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/27/release-apache-apisix-2.9">Release Apache APISIX 2.9</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/25/using-the-apache-apisix-openid-connect-plugin-for-centralized-authentication">Centralized authentication using the OpenID Connect plug-in for Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/25/why-apache-apisix-chose-nginx-and-lua">Why Apache APISIX chose Nginx and Lua to build API Gateway</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/24/shanghai-meetup-recap">Apache APISIX Meetup in Shanghai</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/23/apachecon-asia-2021">ApacheCon Asia 2021</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/23/weekly-report">Apache APISIX Á§æÂå∫Âë®Êä• ÔΩú 2021 8.16-8.22</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/21/shanghai-meetup">Apache APISIX Meetup in Shanghai, welcome to register!</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/19/go-makes-apache-apisix-better">How to use Go to develop Apache APISIX plugin</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/19/weekly-report">Apache APISIX Á§æÂå∫Âë®Êä• ÔΩú 08-09 ÔΩû 08-15</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/18/auth-with-casbin-in-apache-apisix">Licensing with Casbin in Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/17/interview-airwallex">Interview with Yang to explore API gateway in Airwallex</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/16/using-the-apache-apisix-openid-connect-plugin-for-centralized-authentication">Using the Apache APISIX OpenID Connect Plugin for Okta Centralized Authentication</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/14/contributors-the-golden-metric-of-opensource-projects">Contributors ‚Äî The Golden Metric of OpenSource Projects</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/12/chaos-mesh-helps-apache-apisix-improve-system-stability">Chaos Mesh Helps Apache APISIX Improve System Stability</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/11/interview-tuzhengsong">My first PR in the Apache APISIX community</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/10/apisix-nginx">APISIX Architecture: How to Dynamically Manage NGINX Cluster?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/09/apache-apisix-in-china-mobile-cloud">Apache APISIX Âú®ÁßªÂä®‰∫ëÁöÑÂ∫îÁî®</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/09/apache-apisix-in-quliankeji">Abandoning Kong and Nginx, Hyperchain Technology implements on its BaaS platform</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/06/using-apache-apisix-to-improve-the-observability-of-nginx">How to Improve the Observability of Nginx with Apache APISX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/08/05/kong-to-apisix">Kong-To-APISIX Migration Tool</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/07/28/release-apache-apisix-2.8">Release Apache APISIX 2.8.0</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/07/27/use-of-plugin-orchestration-in-apache-apisix">Apply Plugin Orchestration in Apache APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/07/25/apachecon-asia">ApacheCon Asia 2021: Apache APISIX Technical Topics</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/07/21/apache-apisix-kubernetes">Live | Apache APISIX x Kubernetes</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/07/06/the-road-to-customization-of-sina-weibo-api-gateway-based-on-apache-apisix">The Road to Customized Development of Sina Weibo API Gateway</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/07/06/celebrate-200-contributors">Apache APISIX has over 200 contributors in GitHub main repo! </a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/30/etcd3-support-http-access-perfectly">Does etcd 3 Support HTTP Access Perfectly?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/29/release-apache-apisix-2.7">Release Apache APISIX 2.7.0</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/28/why-we-need-apache-apisix">Why do you need Apache APISIX when you have NGINX and Kong?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/23/deploy-great-open-source-gateway-and-ingress-controller-fast">Deploy APISIX and APISIX Ingress Controller on Rancher</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/21/use-java-to-write-apache-apisix-plugins">How to Write an Apache APISIX Plugin in Java</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/18/first-ga-version-v1.0-of-apache-apisix-ingress-controller-released">APISIX Ingress Controller 1.0 Release</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/17/apache-apisix-dashboard-access-control-bypass-vulnerability-announcement">APISIX Dashboard Access Control Bypass Vulnerability Advisory (CVE-2021-33190)</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/16/chaos-mesh-helps-apache-apisix-improve-stability">Chaos Mesh Helps Apache APISIX Improve Stability</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/10/apache-apisix-and-envoy-performance-comparison">Apache APISIX v.s Envoy: Which Has the Better Performance?</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/07/apache-apisix-not-affected-by-nginx-cve-2021-23017">Apache APISIX not affected by NGINX CVE-2021-23017</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/06/06/apisix-two-years">Apache APISIX Open Source 2 Year Anniversary!</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/blog/2021/06/03/firsthand-experience-with-apache-apisix-from-ospp-2020-students">First Experience with Apache APISIX Shared by Student in OSPP 2020</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/05/25/apache-apisix-2.6.0-release">Apache APISIX Release 2.6.0</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/05/24/tencent-games">API Gateway Practice in Tencent with APISIX</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/03/02/get-front-end-test-coverage-with-cypress">Get Front-End Test Coverage with Cypress</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/02/26/install-apache-apisix-from-helm-charts">Install Apache APISIX from Helm Charts</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/02/08/stable-product-delivery-with-cypress">Stable Product Delivery with Cypress</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/01/21/run-ingress-apisix-on-amazon-eks">Run Ingress APISIX on Amazon EKS</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2021/01/11/interview-apache-apisix-contributor-wang-pengcheng-senior-security-advisor-of-pwc-south-china-data-security-and-privacy-protection-team">Apache APISIX Contributor Interview | Pengcheng Wang, Senior Security Consultant, PricewaterhouseCoopers China Data Security &amp; Privacy Team</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2020/12/18/first-look-at-kubernetes-service-api">A First Look at Kubernetes Service APIs</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2020/12/16/another-way-to-implement-envoy-filter">Envoy and Apache APISIX: Another way to implement the Envoy filter</a></li><li class="sidebarItem_iLZw"><a class="sidebarItemLink_Y3HD" href="/blog/2020/12/11/beike-how-to-build-gateway-based-on-apache-apisix">Ke Holdings Inc chooses Apache APISIX as API Gateway</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_XRV4" itemprop="headline">HashiCorp Vault Secure Storage Backend in Apache APISIX Ecosystem</h1><div class="blogPostData_cftJ margin-vert--md"><time datetime="2022-01-21T00:00:00.000Z" itemprop="datePublished">January 21, 2022</time> ¬∑ 13 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_qo3C"><div class="avatar margin-bottom--sm"><a href="https://github.com/bisakhmondal" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_dLSm" src="https://avatars.githubusercontent.com/u/41498427?v=4" alt="Bisakh Mondal"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/bisakhmondal" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Bisakh Mondal</span></a></div><small class="avatar__subtitle" itemprop="description">Author</small></div></div></div><div class="col col--6 authorCol_qo3C"><div class="avatar margin-bottom--sm"><a href="https://github.com/yzeng25" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_dLSm" src="https://avatars.githubusercontent.com/u/36651058?v=4" alt="Yilin Zeng"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/yzeng25" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Yilin Zeng</span></a></div><small class="avatar__subtitle" itemprop="description">Technical Writer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><blockquote><p>This article brings you the upcoming release of the Vault-Apache APISIX integration and related details.</p></blockquote><p>With the rise of microservice-based architecture, keeping things secure has become much more challenging than earlier. We are far beyond the point where our 100 instances of backend servers are accessing our database server with a single static secret credential because if in case of a credential leakage the whole system is compromised and revocation of that credential causes a massive service outage (now no one can access anything unless the instances are reconfigured). We can&#x27;t eliminate the possibility of a security breach because sometimes unexpected does happen. Instead, it&#x27;s totally up to us to control the blast radius in these situations. To tackle scenarios like this, a popular solution like <a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer">HashiCorp Vault</a> comes into the picture in a production environment to act as an identity-based secrets and encryption management system. In this article, I have demonstrated how to integrate Vault with Apache APISIX (a cloud-native API Gateway) <a href="https://apisix.apache.org/docs/apisix/plugins/jwt-auth" target="_blank" rel="noopener noreferrer">jwt-auth plugin</a> to effectively use excellence from both worlds.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_c7R8" id="what-is-vault"></a>What is Vault<a class="hash-link" href="#what-is-vault" title="Direct link to heading">#</a></h2><p>HashiCorp Vault is designed to help organizations manage access to secrets and transmit them safely within an organization. Secrets are defined as any form of sensitive credentials that need to be tightly controlled and monitored and can be used to unlock sensitive information. Secrets could be in the form of passwords, API keys, SSH keys, RSA tokens, or OTP. In the real world where it is very common to have a secret sprawl where secrets get stored into the config file or as a variable in actual program code which as a consequence sometimes even end up in a version control system like GitHub, BitBucket or GitLab, possess a major threat in security. Vault solves this problem by centralizing secrets. It provides encrypted storage for static secrets, generation of dynamic secrets with a TTL lease, authentication of users (machines or humans) to make sure they‚Äôre authorized to access a particular secret and many more. So that even in case of a security breach the blast radius is much small and contained.</p><p>Vault makes it very easy to control and manage access by providing us with a unilateral interface to manage every secret in your infrastructure. Not only that, it also provides the flexibility to create detailed audit logs and keep track of who accessed what.</p><p></p><div class="rc-image"><img alt="HashiCorp Vault" class="rc-image-img" src="https://static.apiseven.com/202108/1642770417379-a91960a5-5aac-45fa-9277-801a4ee2afc6.png"><div class="rc-image-mask">Click to Preview</div></div><p></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_c7R8" id="about-apisix-jwt-auth-plugin"></a>About APISIX jwt-auth Plugin<a class="hash-link" href="#about-apisix-jwt-auth-plugin" title="Direct link to heading">#</a></h2><p>It is an authentication plugin that can be attached to any APISIX route to perform JWT (JSON web token, <a href="https://jwt.io/introduction" target="_blank" rel="noopener noreferrer">read more</a>) authentication before the request gets forwarded to the upstream URI. In short, it is a secure authentication mechanism that leads to authorization to critical resources. Typically, a private key, or a text secret, is used by the issuer to sign the JWT. The receiver of the JWT will verify the signature to ensure that the token hasn‚Äôt been altered after it was signed by the issuer. The total integrity of the whole jwt mechanism depends on the signing secret (may it be a text secret of RSA keypairs). That makes it difficult for unauthenticated sources to guess the signing key and attempt to change the claims within the JWT.</p><p>So the storage of these keys in a secure environment is extremely crucial. Falling into wrong hands may jeopardize the security of the whole infrastructure. Though we from the APISIX side take all the means to follow standard SecOps practices, it&#x27;s quite natural in the production environment to have a centralized key management solution like HashiCorp vault to have elaborate audit trails, periodic key rotation, key revocation etc. And it would be quite a troublesome issue if each time you have to update Apache APISIX configuration whenever a key rotation occurs throughout the infrastructure.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_c7R8" id="steps-to-use-vault-with-apache-apisix"></a>Steps to Use Vault with Apache APISIX<a class="hash-link" href="#steps-to-use-vault-with-apache-apisix" title="Direct link to heading">#</a></h2><p>For integration with Vault, Apache APISIX needs to be loaded with vault configuration at <a href="https://github.com/apache/apisix/blob/master/conf/config.yaml" target="_blank" rel="noopener noreferrer">config.yaml</a>.</p><p>Internally, APISIX communicates with vault server <a href="https://www.vaultproject.io/docs/secrets/kv/kv-v1" target="_blank" rel="noopener noreferrer">KV secret engine v1</a> HTTP <a href="https://www.vaultproject.io/api/secret/kv/kv-v1" target="_blank" rel="noopener noreferrer">APIs</a>. As most enterprise solution prefers to stick with KV Secrets Engine - Version 1 in their production environment, during the initial phase of APISIX-Vault support we have gone with version 1 only. In later releases, we will add the support of K/V version 2.</p><p>The main idea of using vault, instead of the APISIX etcd backend is the security concern in a low trust environment. We, the APISIX developers, understand your priorities seriously. That&#x27;s why we recommend using vault access tokens that are short scoped and can grant APISIX server limited access.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_c7R8" id="configure-vault"></a>Configure Vault<a class="hash-link" href="#configure-vault" title="Direct link to heading">#</a></h3><p>If you have already a Vault instance running with the necessary privileges, feel free to skip this section. This section shares the best practices to use Vault inside the Apache APISIX ecosystem. Please follow the steps mentioned below.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_c7R8" id="step-1-spin-up-a-vault-server"></a>Step 1: Spin Up a Vault Server<a class="hash-link" href="#step-1-spin-up-a-vault-server" title="Direct link to heading">#</a></h4><p>Here you have multiple options, feel free to choose between docker, precompiled binary or building from source. As to communicate with the vault server, you need a vault CLI client, I would prefer going with precompiled binary instead of the Docker approach. Anyway, it&#x27;s totally up to you (feel free to consult <a href="https://www.vaultproject.io/docs/install" target="_blank" rel="noopener noreferrer">Vault&#x27;s official installation docs</a>). To spin up a development server, please run the following command.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ vault server -dev -dev-root-token-id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">root</span></span><span class="token-line" style="color:#393A34"><span class="token plain">‚Ä¶</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> dev mode is enabled</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> In this mode, Vault runs entirely in-memory</span></span><span class="token-line" style="color:#393A34"><span class="token plain">and starts unsealed with a single unseal key. The root token is already</span></span><span class="token-line" style="color:#393A34"><span class="token plain">authenticated to the CLI, so you can immediately begin using Vault.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">You may need to </span><span class="token builtin class-name">set</span><span class="token plain"> the following environment variable:</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">VAULT_ADDR</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://127.0.0.1:8200&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">The unseal key and root token are displayed below </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> you want to</span></span><span class="token-line" style="color:#393A34"><span class="token plain">seal/unseal the Vault or re-authenticate.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Unseal Key: 12hURx2eDPKK1tzK+8TkgH9pPhPNJFpyfc/imCLgJKY</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Root Token: root</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Development mode should NOT be used </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> production installations</span><span class="token operator" style="color:#393A34">!</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Set your current CLI with the correct environment variables.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">VAULT_ADDR</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://127.0.0.1:8200&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">VAULT_TOKEN</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Enable vault k/v version 1 secret engine backend with a suitable path prefix. In this demo, we are going to choose the <code>kv</code> path so that we don&#x27;t have a collision with the vault default secret path for kv version 2.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ vault secrets </span><span class="token builtin class-name">enable</span><span class="token plain"> -path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">kv -version</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> kv</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Success</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> Enabled the kv secrets engine at: kv/</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># To reconfirm the status, run</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vault secrets list</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Path          Type         Accessor              Description</span></span><span class="token-line" style="color:#393A34"><span class="token plain">----          ----         --------              -----------</span></span><span class="token-line" style="color:#393A34"><span class="token plain">cubbyhole/    cubbyhole    cubbyhole_4eeb394c    per-token private secret storage</span></span><span class="token-line" style="color:#393A34"><span class="token plain">identity/     identity     identity_5ca6201e     identity store</span></span><span class="token-line" style="color:#393A34"><span class="token plain">kv/           kv           kv_92cd6d37           n/a</span></span><span class="token-line" style="color:#393A34"><span class="token plain">secret/       kv           kv_6dd46a53           key/value secret storage</span></span><span class="token-line" style="color:#393A34"><span class="token plain">sys/          system       system_2045ddb1       system endpoints used </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> control, policy and debugging</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_c7R8" id="step-2-generate-a-vault-access-token-for-apisix"></a>Step 2: Generate a Vault Access Token for APISIX<a class="hash-link" href="#step-2-generate-a-vault-access-token-for-apisix" title="Direct link to heading">#</a></h4><p>This article is regarding using vault in <code>jwt-auth</code> plugin perspective. So, for an APISIX consumer (if you are unfamiliar with consumers in the APISIX ecosystem, please read the <a href="https://apisix.apache.org/docs/apisix/terminology/consumer" target="_blank" rel="noopener noreferrer">document about Apache APISIX Consumer</a>) with username <code>jack</code> the <code>jwt-auth</code> plugin looks up (if enabled with vault configuration) for secret/s at <code>&lt;vault.prefix inside config.yaml&gt;/consumer/&lt;consumer.username&gt;/jwt-auth</code> into vault kv storage. In this context, if you are assigning <code>kv/apisix</code> namespace (vault path) as <code>vault.prefix</code> inside config.yaml for all apisix related data retrieval, we suggest you to create a policy for path <code>kv/apisix/consumer/*</code>. The extra asterisk (*) at the end ensure the policy allows read for any path that has a <code>kv/apisix/consumer</code> prefix.</p><p>Create a policy file in HashiCorp Configuration Language (HCL).</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> apisix-policy.hcl </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">EOF</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">path &quot;kv/apisix/consumer/*&quot; {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    capabilities = [&quot;read&quot;]</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EOF</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Applying the policy into vault instance.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ vault policy </span><span class="token function" style="color:#d73a49">write</span><span class="token plain"> apisix-policy apisix-policy.hcl</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Success</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> Uploaded policy: apisix-policy</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Generate a token with the newly defined policy that has been configured with the small access boundary.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ vault token create -policy</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;apisix-policy&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Key                  Value</span></span><span class="token-line" style="color:#393A34"><span class="token plain">---                  -----</span></span><span class="token-line" style="color:#393A34"><span class="token plain">token                s.KUWFVhIXgoRuQbbp3j1eMVGa</span></span><span class="token-line" style="color:#393A34"><span class="token plain">token_accessor       nPXT3q0mfZkLmhshfioOyx8L</span></span><span class="token-line" style="color:#393A34"><span class="token plain">token_duration       768h</span></span><span class="token-line" style="color:#393A34"><span class="token plain">token_renewable      </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">token_policies       </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;apisix-policy&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">identity_policies    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">policies             </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;apisix-policy&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;default&quot;</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>In this demonstration <code>s.KUWFVhIXgoRuQbbp3j1eMVGa</code> is your access token.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_c7R8" id="adding-vault-configuration-into-apache-apisix"></a>Adding vault configuration into Apache APISIX<a class="hash-link" href="#adding-vault-configuration-into-apache-apisix" title="Direct link to heading">#</a></h3><p>As discussed earlier, Apache APISIX communicates with Vault instance through Vault HTTP APIs. The necessary configuration must be added into <a href="https://github.com/apache/apisix/blob/master/conf/config.yaml" target="_blank" rel="noopener noreferrer">config.yaml</a>.
Here is the brief information about different fields that you can use:</p><ul><li>host: The host address where the vault server is running.</li><li>timeout: HTTP timeout for each request.</li><li>token: The generated token from vault instance that can grant access to read data from the vault.</li><li>prefix: enabling a prefix allows you to better enforcement of policies, generate limited scoped tokens and tightly control the data that can be accessed from APISIX. Valid prefixes are (<code>kv/apisix</code>, <code>secret</code> etc.)</li></ul><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">vault:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  host: </span><span class="token string" style="color:#e3116c">&#x27;http://0.0.0.0:8200&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  timeout: </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  token: </span><span class="token string" style="color:#e3116c">&#x27;s.KUWFVhIXgoRuQbbp3j1eMVGa&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  prefix: </span><span class="token string" style="color:#e3116c">&#x27;kv/apisix&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_c7R8" id="create-an-apisix-consumer"></a>Create an APISIX Consumer<a class="hash-link" href="#create-an-apisix-consumer" title="Direct link to heading">#</a></h3><p>APISIX has a consumer-level abstraction that goes side by side with authentication scenarios. To enable authentication for any APISIX route, a consumer is needed with a suitable configuration for that specific type of authentication service. Then only APISIX can forward the request to the upstream URI by successfully performing authentication wrt. the consumer configuration. APISIX consumer has two fields - one is <code>username</code> (required) to identify one consumer from the others and another is <code>plugins</code> that holds the consumer specific plugin configurations.</p><p>Here, in this article, we will create a consumer with <code>jwt-auth</code> plugin. It performs JWT authentication for the respective route/s or service/s.</p><p>To enable <code>jwt-auth</code> with vault configuration, make a request to:</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/consumers -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;username&quot;: &quot;jack&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;jwt-auth&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;key&quot;: &quot;test-key&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;vault&quot;: {}</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Here the plugin looks up for key secret inside vault path (<code>&lt;vault.prefix from conf.yaml&gt;/consumer/jack/jwt-auth</code>) for consumer <code>jack</code> mentioned in the consumer config and uses it for subsequent signing and jwt verification. If the key is not found in the same path, the plugin logs error and fails to perform jwt authentication.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_c7R8" id="set-up-a-test-upstream-server"></a>Set Up a Test Upstream Server<a class="hash-link" href="#set-up-a-test-upstream-server" title="Direct link to heading">#</a></h4><p>To test the behaviour, you can create a route for an upstream (a simple ping handler that returns pong). You can set it up with a plain go HTTP-Server.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O go"><pre tabindex="0" class="prism-code language-go codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// simple upstream server</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;net/http&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResponseWriter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> req </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;secure/pong\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">HandleFunc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/secure/ping&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ping</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ListenAndServe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;:9999&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_c7R8" id="create-an-apisix-route-with-authentication-enabled"></a>Create an APISIX Route with Authentication Enabled<a class="hash-link" href="#create-an-apisix-route-with-authentication-enabled" title="Direct link to heading">#</a></h4><p>Create an APISIX route with this secure ping HTTP server and <code>jwt-auth</code> authentication plugin enabled.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/routes/1 -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;jwt-auth&quot;: {}</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;upstream&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;nodes&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;127.0.0.1:9999&quot;: 1</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        },</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot;: &quot;roundrobin&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;uri&quot;: &quot;/secure/ping&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_c7R8" id="generate-token-from-jwt-auth-plugin"></a>Generate Token from jwt-auth Plugin<a class="hash-link" href="#generate-token-from-jwt-auth-plugin" title="Direct link to heading">#</a></h4><p>Now sign a jwt secret from APISIX that can be used and passed for making requests to the <code>http://localhost:9080/secure/ping</code> proxy route to the APISIX server.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/plugin/jwt/sign</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">?key</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">test-key -i</span></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> OK</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Tue, </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> Jan </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> 07:50:57 GMT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/plain</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">charset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">utf-8</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer-Encoding: chunked</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: APISIX/2.11.0</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJ0ZXN0LWtleSIsImV4cCI6MTY0MjU3ODY1N30.nkyev1_KUapVgY_QVYETsSApA6gEkDWS8tsHFV1EpD8</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>In the previous step, if you see something like the <code>failed to sign jwt</code> message please make sure you have a secret key stored into vault <code>kv/apisix/consumers/jack/jwt-auth</code> path.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># example</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vault kv put kv/apisix/consumer/jack/jwt-auth </span><span class="token assign-left variable" style="color:#36acaa">secret</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$ecr3t</span><span class="token plain">-c0d3</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Success</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> Data written to: kv/apisix/consumer/jack/jwt-auth</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_c7R8" id="request-apisix-server"></a>Request APISIX Server<a class="hash-link" href="#request-apisix-server" title="Direct link to heading">#</a></h4><p>Now, make a request to the APISIX proxy for route <code>/secure/ping</code>. Upon successful validation, it will forward the request to our go HTTP server.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/secure/ping -H </span><span class="token string" style="color:#e3116c">&#x27;Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJ0ZXN0LWtleSIsImV4cCI6MTY0MjU3ODU5M30.IYudBr7FTgRme70u4rEBoYNtGmGByzgfGlt8hctI__Q&#x27;</span><span class="token plain"> -i</span></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> OK</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/plain</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">charset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">utf-8</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Tue, </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> Jan </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> 08:00:04 GMT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: APISIX/2.11.0</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">secure/pong</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Any request without a valid jwt will throw an <code>HTTP 401 Unauthorized</code> error.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/secure/ping -i</span></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 </span><span class="token number" style="color:#36acaa">401</span><span class="token plain"> Unauthorized</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Tue, </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> Jan </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> 08:00:33 GMT</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/plain</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">charset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">utf-8</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer-Encoding: chunked</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: APISIX/2.11.0</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;Missing JWT token in request&quot;</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_c7R8" id="different-use-cases-where-vault-can-be-integrated-with-apisix-jwt-auth-plugin"></a>Different Use Cases Where Vault Can be Integrated with APISIX jwt-auth plugin<a class="hash-link" href="#different-use-cases-where-vault-can-be-integrated-with-apisix-jwt-auth-plugin" title="Direct link to heading">#</a></h3><p>Apache APISIX <code>jwt-auth</code> plugin can be configured to fetch simple text secret keys as well as RS256 public-private key pairs from vault storage.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For the early version of this integration support, the plugin expects the key name of secrets stored into the vault path is among [ <code>secret</code>, <code>public_key</code>, <code>private_key</code>] to successfully use the key. In future releases, we are going to add the support of referencing custom-named keys.</p></div></div><ol><li><p>You have stored HS256 signing secret inside the vault and you want to use it for jwt signing and verification.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/consumers -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &quot;username&quot;: &quot;jack&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &quot;plugins&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         &quot;jwt-auth&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;key&quot;: &quot;key-1&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;vault&quot;: {}</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> }&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>Here the plugin looks up for key <code>secret</code> inside vault path (<code>&lt;vault.prefix from conf.yaml&gt;/consumer/jack/jwt-auth</code>) for consumer jack mentioned in the consumer config and uses it for subsequent signing and jwt verification. If the key is not found in the same path, the plugin logs an error and fails to perform jwt authentication.</p></li><li><p>RS256 RSA keypairs, both public and private keys are stored in the vault.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/consumers -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &quot;username&quot;: &quot;jim&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &quot;plugins&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         &quot;jwt-auth&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;key&quot;: &quot;rsa-keypair&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;algorithm&quot;: &quot;RS256&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;vault&quot;: {}</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> }&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>The plugin looks up for <code>public_key</code> and <code>private_key</code> keys inside vault kv path (<code>&lt;vault.prefix from conf.yaml&gt;/consumer/jim/jwt-auth</code>) for <code>jim</code> mentioned inside plugin vault configuration. If not found, authentication fails.</p><p>If you are unsure, how to store public and private keys into vault kv storage, use this command</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># provided, your current directory contains the files named &quot;public.pem&quot; and &quot;private.pem&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> $ vault kv put kv/apisix/consumer/jim/jwt-auth </span><span class="token assign-left variable" style="color:#36acaa">public_key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">@public.pem </span><span class="token assign-left variable" style="color:#36acaa">private_key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">@private.pem</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> Success</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> Data written to: kv/apisix/consumer/jim/jwt-auth</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div></li><li><p>Public key in consumer configuration, while the private key is in the vault.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/consumers -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &quot;username&quot;: &quot;john&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     &quot;plugins&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         &quot;jwt-auth&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;key&quot;: &quot;user-key&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;algorithm&quot;: &quot;RS256&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;public_key&quot;: &quot;-----BEGIN PUBLIC KEY-----\n‚Ä¶‚Ä¶\n-----END PUBLIC KEY-----&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">             &quot;vault&quot;: {}</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> }&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><p>This plugin uses RSA public key from consumer configuration and uses the private key directly fetched from the vault.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_c7R8" id="disable-vault-from-plugin"></a>Disable Vault from Plugin<a class="hash-link" href="#disable-vault-from-plugin" title="Direct link to heading">#</a></h3><p>Now, to disable the vault lookup from the <code>jwt-auth</code> plugin simply remove the empty vault object from the consumer plugin configuration (in this case it is <code>jack</code>). This will make the jwt plugin to lookup signing secrets (both HS256/HS512 or RS512 keypairs) into plugin configuration for subsequent requests to the URI route where the <code>jwt-auth</code> configuration has been enabled. Even if you have vault configuration enabled in APISIX <code>config.yaml</code> no request will be sent to the vault server.</p><p>APISIX plugins are hot-reloaded, therefore is no need to restart APISIX.</p><div class="codeBlockContainer_8r9j"><div class="codeBlockContent_6g8O shell"><pre tabindex="0" class="prism-code language-shell codeBlock_U6z7 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_qR4p"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> http://127.0.0.1:9080/apisix/admin/consumers -H </span><span class="token string" style="color:#e3116c">&#x27;X-API-KEY: edd1c9f034335f136f87ad84b625c8f1&#x27;</span><span class="token plain"> -X PUT -d </span><span class="token string" style="color:#e3116c">&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">{</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;username&quot;: &quot;jack&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;plugins&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;jwt-auth&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;key&quot;: &quot;test-key&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            &quot;secret&quot;: &quot;my-secret-key&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_ycDu clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_c7R8" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>This article brings you the upcoming release of the Vault-Apache APISIX integration and related details.</p><p>Feel free to start a discussion in <a href="https://github.com/apache/apisix/discussions" target="_blank" rel="noopener noreferrer">GitHub Discussions</a> or communicate via the <a href="https://apisix.apache.org/docs/general/join" target="_blank" rel="noopener noreferrer">mailing list</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_c7R8" id="reference"></a>Reference<a class="hash-link" href="#reference" title="Direct link to heading">#</a></h2><p><a href="https://blog.bisakh.com/blog/vault-apisix-jwt-auth" target="_blank" rel="noopener noreferrer">Bisakh&#x27;s Blog</a></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_GzFC"><div class="col"><b>Tags:</b><ul class="tags_5N4j padding--none margin-left--sm"><li class="tag_LKyA"><a class="tag_JoRF tagRegular_BENv" href="/blog/tags/technology">Technology</a></li><li class="tag_LKyA"><a class="tag_JoRF tagRegular_BENv" href="/blog/tags/authentication">Authentication</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/01/24/apisix-with-qingcloud-meetup"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ Webinar | APISIX in QingCloud! </div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/01/21/apisix-xrpc-details-and-miltilingual"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Get More Details About xRPC ¬ª</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_thVJ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-vault" class="table-of-contents__link">What is Vault</a></li><li><a href="#about-apisix-jwt-auth-plugin" class="table-of-contents__link">About APISIX jwt-auth Plugin</a></li><li><a href="#steps-to-use-vault-with-apache-apisix" class="table-of-contents__link">Steps to Use Vault with Apache APISIX</a><ul><li><a href="#configure-vault" class="table-of-contents__link">Configure Vault</a></li><li><a href="#adding-vault-configuration-into-apache-apisix" class="table-of-contents__link">Adding vault configuration into Apache APISIX</a></li><li><a href="#create-an-apisix-consumer" class="table-of-contents__link">Create an APISIX Consumer</a></li><li><a href="#different-use-cases-where-vault-can-be-integrated-with-apisix-jwt-auth-plugin" class="table-of-contents__link">Different Use Cases Where Vault Can be Integrated with APISIX jwt-auth plugin</a></li><li><a href="#disable-vault-from-plugin" class="table-of-contents__link">Disable Vault from Plugin</a></li></ul></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li><li><a href="#reference" class="table-of-contents__link">Reference</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ASF</div><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation</a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License</a></li><li class="footer__item"><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events</a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/apisix/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/general/join">Slack</a></li><li class="footer__item"><a href="https://twitter.com/ApacheAPISIX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgPD18cMhOg5rmPVnQhAC8g" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/showcase">Showcase</a></li><li class="footer__item"><a class="footer__link-item" href="/plugins">Plugin Hub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_fkq+"><img src="https://static.apiseven.com/202202/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_3EHU themedImage--light_heW6 footer__logo"><img src="https://static.apiseven.com/202202/asf_logo_wide_small.png" alt="Apache Software Foundation" class="themedImage_3EHU themedImage--dark_6pZL footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2019-2022 The Apache Software Foundation. Apache APISIX, APISIX¬Æ, Apache, the Apache feather logo, and the Apache APISIX project logo are either registered trademarks or trademarks of the Apache Software Foundation.</div></div></div></footer></div>
<script src="https://apisix-website-static.apiseven.com/assets/js/runtime~main.f3244aab.js"></script>
<script src="https://apisix-website-static.apiseven.com/assets/js/main.86bd6361.js"></script>
</body>
<script>window.onload=function(){window.location.host.endsWith(".netlify.app")&&document.querySelector("#__docusaurus").insertAdjacentHTML("afterend",'<div style="text-align: right;padding: 48px 32px 48px 0;">This site is powered by <a href="https://www.netlify.com/" target="_blank">Netlify</a></div>')}</script>
</html>